<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Auto Stat Description Editor</title>
  <link rel="stylesheet" href="/static/editor.css">
</head>
<body>
  <div class="bg-shape bg-shape-a"></div>
  <div class="bg-shape bg-shape-b"></div>
  <div class="app-shell">
    <header class="topbar card">
      <div>
        <p class="eyebrow">Auto Stat Description</p>
        <h1>Description Editor</h1>
        <p class="subtext">Design your Strava description template with live preview.</p>
      </div>
      <div class="status-block" id="topStatus">Ready</div>
    </header>

    <section class="actions card">
      <button id="btnLoadActive" class="btn">Load Active</button>
      <button id="btnLoadDefault" class="btn btn-ghost">Load Default</button>
      <button id="btnLoadDraft" class="btn btn-ghost" title="Load your locally saved browser draft">Load Draft</button>
      <button id="btnSaveDraft" class="btn btn-ghost" title="Save current editor content locally in your browser">Save Draft</button>
      <button id="btnFormatTemplate" class="btn btn-ghost" title="Normalize line endings, trim trailing spaces, and collapse large blank blocks">Format</button>
      <button id="btnValidate" class="btn btn-secondary">Validate</button>
      <button id="btnPreview" class="btn btn-secondary">Preview</button>
      <button id="btnSave" class="btn btn-primary">Save + Publish</button>
      <button id="btnCopyPreview" class="btn btn-ghost">Copy Preview</button>
      <label class="toggle-inline" for="autoPreviewToggle">
        <input id="autoPreviewToggle" type="checkbox" checked>
        Auto-preview
      </label>
      <label class="toggle-inline" for="themeToggle">
        <input id="themeToggle" type="checkbox" checked>
        Dark Mode
      </label>
    </section>

    <main class="layout">
      <aside class="panel card reveal" style="--delay:0.03s">
        <h2>Available Data</h2>
        <p class="subtext">Click any field to insert it into the advanced editor.</p>
        <label class="stack-label" for="schemaContextMode">Catalog Context</label>
        <select id="schemaContextMode" class="search">
          <option value="sample" selected>Sample Only</option>
          <option value="fixture">Fixture</option>
          <option value="latest">Latest Only</option>
          <option value="latest_or_sample">Latest or Sample</option>
        </select>
        <label class="stack-label" for="schemaSourceFilter">Source Filter</label>
        <select id="schemaSourceFilter" class="search">
          <option value="all" selected>All Sources</option>
        </select>
        <label class="stack-label" for="schemaGroupFilter">Group Filter</label>
        <select id="schemaGroupFilter" class="search">
          <option value="all" selected>All Groups</option>
        </select>
        <label class="stack-label" for="schemaTypeFilter">Type Filter</label>
        <select id="schemaTypeFilter" class="search">
          <option value="all" selected>All Types</option>
        </select>
        <label class="stack-label" for="schemaTagFilter">Tag Filter</label>
        <select id="schemaTagFilter" class="search">
          <option value="all" selected>All Tags</option>
        </select>
        <label class="toggle-inline" for="schemaCuratedOnly">
          <input id="schemaCuratedOnly" type="checkbox">
          Curated Fields Only
        </label>
        <input id="schemaSearch" class="search" type="search" placeholder="Search fields...">
        <div id="schemaMeta" class="meta"></div>
        <div id="catalogDiagnostics" class="meta">No diagnostics yet.</div>
        <div id="schemaList" class="catalog"></div>
      </aside>

      <section class="panel card reveal" style="--delay:0.07s">
        <div class="tabbar">
          <button class="tab active" data-tab="simple">Simple Builder</button>
          <button class="tab" data-tab="advanced">Advanced Template</button>
        </div>

        <div id="tabSimple" class="tabpanel active">
          <p class="subtext">Toggle sections, reorder them, then apply to the advanced editor.</p>
          <div id="simpleSections" class="sections"></div>
          <div class="inline-actions">
            <button id="btnSimpleApply" class="btn btn-secondary">Apply To Advanced</button>
            <button id="btnSimpleReset" class="btn btn-ghost">Reset Builder</button>
          </div>
        </div>

        <div id="tabAdvanced" class="tabpanel">
          <div class="advanced-toolbar">
            <label for="previewContextMode">Preview Context</label>
            <select id="previewContextMode">
              <option value="sample" selected>Sample Only</option>
              <option value="fixture">Fixture</option>
              <option value="latest_or_sample">Latest or Sample</option>
              <option value="latest">Latest Only</option>
            </select>
            <label for="previewFixtureName">Fixture</label>
            <select id="previewFixtureName">
              <option value="default" selected>default</option>
            </select>
          </div>
          <div class="advanced-toolbar">
            <label for="templateNameInput">Template Name</label>
            <input id="templateNameInput" type="text" placeholder="Auto Stat Template">
            <label for="templateAuthorInput">Author</label>
            <input id="templateAuthorInput" type="text" placeholder="editor-user">
          </div>
          <label for="templateEditor">Jinja Template</label>
          <textarea id="templateEditor" spellcheck="false"></textarea>
          <div class="snippet-shell">
            <div class="snippet-head">
              <h3>Snippet Palette</h3>
              <p class="subtext">Tap to insert starter blocks at your cursor.</p>
            </div>
            <div id="snippetList" class="snippets"></div>
          </div>
          <div id="validationPane" class="validation"></div>
        </div>
      </section>

      <section class="panel card reveal" style="--delay:0.1s">
        <h2>Preview</h2>
        <p class="subtext">Rendered from selected context mode. Sample mode does not call upstream services.</p>
        <div class="meta" id="previewMeta">No preview yet.</div>
        <pre id="previewText" class="preview"></pre>
        <div class="snippet-shell">
          <div class="snippet-head">
            <h3>Template History</h3>
            <p class="subtext">Load or rollback to previous published versions.</p>
            <button id="btnRefreshHistory" class="btn btn-ghost">Refresh History</button>
          </div>
          <div id="templateMeta" class="meta">No template metadata.</div>
          <div id="versionList" class="catalog"></div>
        </div>
      </section>
    </main>
  </div>

  <script src="/static/editor.js"></script>
</body>
</html>
